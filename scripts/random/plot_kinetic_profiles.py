#XXX unfinished

import context, settings
import numpy as np 

n_peaked=1.e19*np.array([
4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.59e+00,4.60e+00,4.60e+00,4.60e+00,4.60e+00,4.60e+00,4.60e+00,4.61e+00,4.61e+00,4.61e+00,4.61e+00,4.61e+00,4.61e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.62e+00,4.61e+00,4.61e+00,4.61e+00,4.61e+00,4.60e+00,4.60e+00,4.60e+00,4.59e+00,4.59e+00,4.58e+00,4.58e+00,4.57e+00,4.56e+00,4.56e+00,4.55e+00,4.54e+00,4.54e+00,4.53e+00,4.52e+00,4.51e+00,4.50e+00,4.49e+00,4.48e+00,4.47e+00,4.46e+00,4.45e+00,4.44e+00,4.43e+00,4.41e+00,4.40e+00,4.39e+00,4.38e+00,4.36e+00,4.35e+00,4.33e+00,4.32e+00,4.30e+00,4.29e+00,4.27e+00,4.26e+00,4.24e+00,4.23e+00,4.21e+00,4.19e+00,4.17e+00,4.16e+00,4.14e+00,4.12e+00,4.10e+00,4.08e+00,4.07e+00,4.05e+00,4.03e+00,4.01e+00,3.99e+00,3.96e+00,3.94e+00,3.92e+00,3.89e+00,3.86e+00,3.83e+00,3.79e+00,3.76e+00,3.72e+00,3.67e+00,3.60e+00,3.40e+00,3.20e+00,2.99e+00,2.78e+00,2.57e+00,2.31e+00])

n_flat=1.e19*np.array([
4.21e+00,4.21e+00,4.21e+00,4.21e+00,4.22e+00,4.22e+00,4.22e+00,4.22e+00,4.23e+00,4.23e+00,4.23e+00,4.24e+00,4.24e+00,4.25e+00,4.25e+00,4.26e+00,4.27e+00,4.27e+00,4.28e+00,4.28e+00,4.29e+00,4.30e+00,4.30e+00,4.31e+00,4.32e+00,4.33e+00,4.33e+00,4.34e+00,4.35e+00,4.36e+00,4.37e+00,4.37e+00,4.38e+00,4.39e+00,4.40e+00,4.41e+00,4.41e+00,4.42e+00,4.43e+00,4.44e+00,4.45e+00,4.45e+00,4.46e+00,4.47e+00,4.48e+00,4.48e+00,4.49e+00,4.50e+00,4.51e+00,4.51e+00,4.52e+00,4.53e+00,4.53e+00,4.54e+00,4.55e+00,4.55e+00,4.56e+00,4.56e+00,4.57e+00,4.57e+00,4.58e+00,4.58e+00,4.59e+00,4.59e+00,4.60e+00,4.60e+00,4.60e+00,4.61e+00,4.61e+00,4.61e+00,4.62e+00,4.62e+00,4.62e+00,4.63e+00,4.63e+00,4.63e+00,4.63e+00,4.63e+00,4.64e+00,4.64e+00,4.64e+00,4.64e+00,4.64e+00,4.64e+00,4.65e+00,4.65e+00,4.65e+00,4.65e+00,4.65e+00,4.65e+00,4.65e+00,4.65e+00,4.65e+00,4.64e+00,4.64e+00,4.63e+00,4.62e+00,4.60e+00,4.58e+00,4.55e+00,4.52e+00,4.49e+00,4.44e+00,4.34e+00,4.06e+00,3.76e+00,3.46e+00,3.16e+00,2.87e+00,2.49e+00])

tor_flux_norm=[
4.55e-03,1.37e-02,2.28e-02,3.19e-02,4.10e-02,5.01e-02,5.92e-02,6.83e-02,7.74e-02,8.65e-02,9.56e-02,1.05e-01,1.14e-01,1.23e-01,1.32e-01,1.41e-01,1.50e-01,1.59e-01,1.68e-01,1.78e-01,1.87e-01,1.96e-01,2.05e-01,2.14e-01,2.23e-01,2.32e-01,2.41e-01,2.50e-01,2.59e-01,2.69e-01,2.78e-01,2.87e-01,2.96e-01,3.05e-01,3.14e-01,3.23e-01,3.32e-01,3.41e-01,3.50e-01,3.60e-01,3.69e-01,3.78e-01,3.87e-01,3.96e-01,4.05e-01,4.14e-01,4.23e-01,4.32e-01,4.41e-01,4.51e-01,4.60e-01,4.69e-01,4.78e-01,4.87e-01,4.96e-01,5.05e-01,5.14e-01,5.23e-01,5.33e-01,5.42e-01,5.51e-01,5.60e-01,5.69e-01,5.78e-01,5.87e-01,5.96e-01,6.05e-01,6.14e-01,6.24e-01,6.33e-01,6.42e-01,6.51e-01,6.60e-01,6.69e-01,6.78e-01,6.87e-01,6.96e-01,7.05e-01,7.15e-01,7.24e-01,7.33e-01,7.42e-01,7.51e-01,7.60e-01,7.69e-01,7.78e-01,7.87e-01,7.96e-01,8.06e-01,8.15e-01,8.24e-01,8.33e-01,8.42e-01,8.51e-01,8.60e-01,8.69e-01,8.78e-01,8.87e-01,8.97e-01,9.06e-01,9.15e-01,9.24e-01,9.33e-01,9.42e-01,9.51e-01,9.60e-01,9.69e-01,9.78e-01,9.88e-01,1.00e+00]

rot_Pr_1_tfte_05=[
5.1787e+01,5.1771e+01,5.1742e+01,5.1700e+01,5.1639e+01,5.1566e+01,5.1475e+01,5.1370e+01,5.1247e+01,5.1106e+01,5.0946e+01,5.0772e+01,5.0587e+01,5.0379e+01,5.0166e+01,4.9931e+01,4.9684e+01,4.9424e+01,4.9159e+01,4.8878e+01,4.8585e+01,4.8286e+01,4.7974e+01,4.7650e+01,4.7318e+01,4.6973e+01,4.6619e+01,4.6259e+01,4.5880e+01,4.5494e+01,4.5097e+01,4.4689e+01,4.4274e+01,4.3847e+01,4.3416e+01,4.2977e+01,4.2532e+01,4.2082e+01,4.1628e+01,4.1174e+01,4.0715e+01,4.0254e+01,3.9794e+01,3.9332e+01,3.8868e+01,3.8411e+01,3.7946e+01,3.7483e+01,3.7026e+01,3.6565e+01,3.6112e+01,3.5655e+01,3.5202e+01,3.4749e+01,3.4298e+01,3.3851e+01,3.3408e+01,3.2962e+01,3.2522e+01,3.2087e+01,3.1652e+01,3.1220e+01,3.0791e+01,3.0367e+01,2.9945e+01,2.9523e+01,2.9108e+01,2.8697e+01,2.8285e+01,2.7876e+01,2.7474e+01,2.7070e+01,2.6671e+01,2.6276e+01,2.5885e+01,2.5496e+01,2.5112e+01,2.4731e+01,2.4352e+01,2.3980e+01,2.3609e+01,2.3243e+01,2.2881e+01,2.2523e+01,2.2166e+01,2.1816e+01,2.1468e+01,2.1124e+01,2.0786e+01,2.0452e+01,2.0126e+01,1.9802e+01,1.9493e+01,1.9192e+01,1.8907e+01,1.8640e+01,1.8392e+01,1.8167e+01,1.7967e+01,1.7787e+01,1.7631e+01,1.7494e+01,1.7338e+01,1.7140e+01,1.5691e+01,1.3549e+01,1.1084e+01,8.3104e+00,5.1525e+00,6.3470e-08]

rot_Pr_03_tfte_2=[
1.7648e+02,1.7643e+02,1.7633e+02,1.7619e+02,1.7598e+02,1.7574e+02,1.7544e+02,1.7509e+02,1.7468e+02,1.7421e+02,1.7368e+02,1.7310e+02,1.7248e+02,1.7179e+02,1.7108e+02,1.7030e+02,1.6948e+02,1.6862e+02,1.6773e+02,1.6680e+02,1.6583e+02,1.6483e+02,1.6380e+02,1.6272e+02,1.6162e+02,1.6047e+02,1.5930e+02,1.5810e+02,1.5684e+02,1.5556e+02,1.5424e+02,1.5288e+02,1.5150e+02,1.5008e+02,1.4865e+02,1.4719e+02,1.4571e+02,1.4422e+02,1.4271e+02,1.4120e+02,1.3968e+02,1.3814e+02,1.3662e+02,1.3508e+02,1.3354e+02,1.3202e+02,1.3048e+02,1.2894e+02,1.2742e+02,1.2589e+02,1.2438e+02,1.2287e+02,1.2136e+02,1.1986e+02,1.1836e+02,1.1687e+02,1.1540e+02,1.1392e+02,1.1246e+02,1.1102e+02,1.0957e+02,1.0814e+02,1.0672e+02,1.0531e+02,1.0391e+02,1.0251e+02,1.0113e+02,9.9764e+01,9.8395e+01,9.7038e+01,9.5702e+01,9.4362e+01,9.3038e+01,9.1727e+01,9.0427e+01,8.9139e+01,8.7864e+01,8.6601e+01,8.5342e+01,8.4106e+01,8.2877e+01,8.1662e+01,8.0460e+01,7.9273e+01,7.8089e+01,7.6929e+01,7.5771e+01,7.4631e+01,7.3512e+01,7.2404e+01,7.1322e+01,7.0251e+01,6.9228e+01,6.8234e+01,6.7294e+01,6.6418e+01,6.5610e+01,6.4882e+01,6.4239e+01,6.3671e+01,6.3184e+01,6.2769e+01,6.2312e+01,6.1767e+01,5.6548e+01,4.8828e+01,3.9944e+01,2.9948e+01,1.8568e+01,6.3470e-08]

import matplotlib.pyplot as plt
fig,ax=plt.subplots(1,1,constrained_layout=True)

axes=[ax]

axes[-1].tick_params(axis='y', labelcolor=settings.cmap_green_nice(0.5))
axes[-1].set_ylabel(r'Deuterium density [m$^{-3}$]',color=settings.cmap_green_nice(0.5)) 
axes[-1].plot(tor_flux_norm,n_flat,label='flat n',linestyle='solid',color=settings.cmap_green_nice(0.))
axes[-1].plot(tor_flux_norm,n_peaked,label='peaked n',linestyle='dashed',color=settings.cmap_green_nice(0.))

axes[-1].set_xlabel(r'Normalised $\rho_{\mathrm{toroidal}}$')
axes[-1].legend(loc='lower left')

axes.append(axes[0].twinx())
axes[-1].tick_params(axis='y', labelcolor=settings.cmap_blue_nice(0.5))
axes[-1].set_ylabel(r'Rotation [km s$^{-1}$]',color=settings.cmap_blue_nice(0.5)) 
axes[-1].plot(tor_flux_norm,rot_Pr_03_tfte_2,label=r'Pr={}, $\tau_{{\Phi}}/\tau_{{\mathrm{{E}}}}={}$'.format(0.3,2.0),linestyle='solid',color=settings.cmap_blue_nice(0.))
axes[-1].plot(tor_flux_norm,rot_Pr_1_tfte_05,label=r'Pr={}, $\tau_{{\Phi}}/\tau_{{\mathrm{{E}}}}={}$'.format(1.0,0.5),linestyle='dashed',color=settings.cmap_blue_nice(0.))

axes[-1].legend(loc='center left')
axes[-1].set_title('Kinetic profiles for 15MA $Q=10$ scenario')


plt.show()

